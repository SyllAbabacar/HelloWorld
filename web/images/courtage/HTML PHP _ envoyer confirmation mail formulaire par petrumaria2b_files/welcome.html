<!DOCTYPE html>
<!-- saved from url=(0056)https://k8t3w3m6.ssl.hwcdn.net/v6/11/12/couponslist.html -->
<html class=" chrome-55"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>brappui List</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./main.css">
  </head>
  <body>

    <div class="brappuilist brappuipopup">
      <div class="brappuicouponslist__items">

      </div>

      <div class="brappuilist__annotation">
        <a href="https://k8t3w3m6.ssl.hwcdn.net/v6/11/12/couponslist.html#"><span id="fd_problems_with_these_results">Gibt es Beanstandungen zu den Ergebnissen?</span></a>
      </div>
    </div>
    <script src="./app.js.téléchargement"></script>
    <script>
        var fd_storage = {
            get: function(key, defaultValue) {
                if (localStorage[key]) {
                    try {
                        return JSON.parse(localStorage[key]);
                    } catch (ex) {
                    }
                }
                if (defaultValue === undefined) {
                    return null;
                }
                return defaultValue;
            },
            set: function(key, newValue) {
                localStorage[key] = JSON.stringify(newValue);
            },
            remove: function(key) {
                if (localStorage[key]) {
                    delete localStorage[key];
                }
            }
        };

        brappui.main.addEventListener(window, 'message', function(msg) {
            var data = null;
        
        try {
            data = JSON.parse(msg.data);
        } catch(e){};

        if (!data || !data.event) {
        return;
		}
            var coupons = '';
            var domain = data.domain;
            var html = document.documentElement;

            if (data.event === 'getCouponsListHeight') {
			    var iframeHeight = html.offsetHeight;
				
			    if (iframeHeight > 320) {
					iframeHeight = 320;
				}


				brappui.main.fireEvent('setCouponsListHeight', {
					height: iframeHeight
				});
				return;
			}
			
			if (typeof (data.coupons) !== 'object') {
                data.coupons = JSON.parse(data.coupons);
            }

            window.coupons = data.coupons;
            for (var i = 0; i < data.coupons.length; i++) {
                var coupon = data.coupons[i];
                if(!coupon.value) {
                    coupon.value = '';
                }
                coupons += '<a href="' + coupon.deep_link
                    + '"  onClick="populateBar(' + coupon.id + ');" target="_blank"><div class="brappuicouponslist__item" ><div class="brappuicouponslist__item__percent inner">'
                    + coupon.value + '</div><div class="brappuicouponslist__item__content inner">'
                    + brappui.main.escapeHtml(coupon.name) + '</div><div class="brappuicouponslist__item__cta inner"><div class="brappuibutton is-listed"><img src="images/icon-right.svg" alt=""></div></div></div></a>';
            }

            document.querySelector('.brappuicouponslist__items').innerHTML = coupons;

            window.populateBar = function(id) {
              var coupon = data.coupons.filter(function(val) {
                return val.id == id;
              });

              fd_storage.set('couponsInExt', {
                  coupon: coupon[0],
                  domain: domain
              });
              //brappui.main.fireEvent('launchBigCouponsBar', coupon);
            };
        });
    </script>
  

</body></html>